name: "Check Zenodo DOI"

on:
    schedule:
        - cron: "0 * * * *" # hourly
    workflow_dispatch: {}

permissions:
    contents: write

jobs:
    check-zenodo:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
              with:
                  fetch-depth: 0

            - name: Set up Python
              uses: actions/setup-python@v4
              with:
                  python-version: "3.11"

            - name: Install dependencies
              run: python -m pip install --upgrade pip

            - name: Run Zenodo checker
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              run: |
                  python scripts/check_zenodo_and_update.py
